/* style.css - Cyber Glow Refresh - Refined */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

/* --- Base Variables --- */
:root {
    --bg-main: #0A0F1E; /* Very dark desaturated blue */
    --bg-panel: #141A2E; /* Darker blue/purple */
    --bg-panel-accent: #1E243E; /* Slightly lighter for modals/accented panels */
    --text-primary: #D0D8E8; /* Light greyish blue */
    --text-secondary: #A0A8C0;
    --accent-blue: #00DFFC;
    --accent-pink: #F800B8;
    --accent-yellow: #F8D800;
    --accent-green: #00F8A8;
    --accent-orange: #F88800;
    --accent-red: #F84800; /* For warnings/errors */

    /* New Bright Accent Colors for Shop/Upgrades */
    --accent-teal: #00F0D0;
    --accent-magenta: #F000F0;
    --accent-lime: #A0F800; /* Lime Green for Quantum */

    /* Multiplier Colors */
    --multiplier-2x-color: #009688; /* Teal */
    --multiplier-3x-color: #9C27B0; /* Purple */
    --multiplier-5x-color: #F44336; /* Red */


    --font-primary: 'Poppins', sans-serif;
    --border-radius-main: 12px;
    --border-radius-small: 8px;
    --shadow-color: rgba(0, 223, 252, 0.1);
    --shadow-color-pink: rgba(248, 0, 184, 0.1);
    --shadow-strong: 0 0 15px var(--shadow-color), 0 0 30px var(--shadow-color);
    --shadow-subtle: 0 4px 15px rgba(0,0,0,0.3);
}

/* --- Animations Redefined --- */
@keyframes popIn {
    0% { opacity: 0; transform: translateY(25px) scale(0.85); }
    70% { opacity: 1; transform: translateY(-8px) scale(1.03); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes payoutShow {
    0% { transform: translateY(15px) scale(0.7); opacity: 0; }
    60% { transform: translateY(-8px) scale(1.2); opacity: 1; }
    100% { transform: translateY(0) scale(1.1); opacity: 1; }
}
@keyframes payoutHide {
    0% { transform: translateY(0) scale(1.1); opacity: 1; }
    100% { transform: translateY(-25px) scale(0.4); opacity: 0; }
}

@keyframes accentGlow {
    0%, 100% { text-shadow: 0 0 5px var(--accent-blue), 0 0 10px var(--accent-blue), 0 0 15px var(--accent-blue); }
    50% { text-shadow: 0 0 8px var(--accent-blue), 0 0 15px var(--accent-blue), 0 0 25px var(--accent-blue); }
}
@keyframes pinkGlow {
    0%, 100% { text-shadow: 0 0 5px var(--accent-pink), 0 0 10px var(--accent-pink); }
    50% { text-shadow: 0 0 8px var(--accent-pink), 0 0 15px var(--accent-pink); }
}
@keyframes limeGlow { /* For Quantum Mode */
    0%, 100% { text-shadow: 0 0 5px var(--accent-lime), 0 0 10px var(--accent-lime), 0 0 15px var(--accent-lime); }
    50% { text-shadow: 0 0 8px var(--accent-lime), 0 0 15px var(--accent-lime), 0 0 25px var(--accent-lime); }
}
@keyframes yellowGlow {
    0%, 100% { text-shadow: 0 0 5px var(--accent-yellow), 0 0 10px var(--accent-yellow); }
    50% { text-shadow: 0 0 8px var(--accent-yellow), 0 0 15px var(--accent-yellow); }
}


@keyframes investmentResult {
    0% { transform: scale(0.6); opacity: 0; }
    60% { transform: scale(1.15); opacity: 1; }
    100% { transform: scale(1); opacity: 1; }
}

@keyframes pulseWarningBorder {
    0% { box-shadow: 0 0 8px var(--accent-red), inset 0 0 5px var(--accent-red); border-color: var(--accent-red); }
    50% { box-shadow: 0 0 15px var(--accent-orange), inset 0 0 8px var(--accent-orange); border-color: var(--accent-orange); }
    100% { box-shadow: 0 0 8px var(--accent-red), inset 0 0 5px var(--accent-red); border-color: var(--accent-red); }
}
.btn-spin-bill-unpaid {
    animation: pulseWarningBorder 1.2s infinite;
    border: 2px solid var(--accent-red) !important;
}
.btn-spin-lucky,
#lucky-btn.active { /* Added #lucky-btn.active here */
    background: linear-gradient(135deg, var(--accent-pink), var(--accent-yellow)) !important;
    border-color: var(--accent-pink) !important;
    color: var(--bg-main) !important;
    box-shadow: 0 0 10px var(--accent-pink), 0 0 5px var(--accent-yellow);
}


/* --- General Styles --- */
body {
    font-family: var(--font-primary);
    background: var(--bg-main);
    display: flex;
    flex-direction: column; /* For title alignment */
    justify-content: flex-start; /* Align title and then container */
    align-items: center;
    min-height: 100vh;
    color: var(--text-primary);
    padding: 20px;
    box-sizing: border-box;
    transition: background 0.5s ease, color 0.5s ease;
    overflow-x: hidden;
}

/* --- Game Title Styling --- */
#game-main-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--accent-blue);
    text-transform: uppercase;
    letter-spacing: 2px;
    margin: 0 auto 15px auto;
    transition: all 0.4s ease-in-out;
    line-height: 1.2;
    text-align: center;
    width: 100%;
}

#game-main-title.upgrade-mode-active { /* General style for active upgrade titles */
    font-size: 28px;
    font-weight: bold;
    letter-spacing: 4px;
}
/* Specific glows will be handled by theme classes */


.main-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 25px;
    flex-wrap: wrap;
    max-width: 1400px;
}

/* --- Panel Styling --- */
.right-panel {
    display: flex;
    flex-direction: column;
    gap: 20px; /* Reduced gap between right-side windows */
    width: 220px;
}

.side-window, .power-meter-container, .status-effects-window, .game, .inventory-window, #guide-popup-window,
.modal-window, .utility-trigger { /* Added .modal-window and .utility-trigger */
    background: var(--bg-panel);
    border-radius: var(--border-radius-main);
    box-shadow: 0 5px 20px rgba(0,0,0,0.5), 0 0 8px var(--shadow-color) inset;
    border: 1px solid transparent;
    padding: 20px;
    transition: background 0.5s ease, border-color 0.5s ease, box-shadow 0.3s ease;
    box-sizing: border-box;
}
.side-window:hover, .game:hover {
     box-shadow: 0 8px 25px rgba(0,0,0,0.6), 0 0 12px var(--shadow-color-pink) inset;
}


#pet-module-window,
#bird-module-window,
#phone-module-window {
    min-height: 280px; /* Shortened */
    height: 280px; /* Shortened */
    display: flex;
    flex-direction: column;
}

.side-window-header {
    font-size: 26px;
    text-align: center;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--accent-blue);
    color: var(--accent-blue);
    font-weight: 600;
    flex-shrink: 0;
    transition: color 0.5s ease, border-color 0.5s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}
#header-cat-emoji {
    font-size: 24px;
}

.side-window-header.toggleable {
    cursor: pointer;
}
.side-window-header.toggleable:hover {
    color: var(--accent-pink);
    border-bottom-color: var(--accent-pink);
}
.side-window-header .large-emoji {
    font-size: 36px;
}
.side-window-content {
    flex-grow: 1;
    display: flex;
    font-size: 16px;
    text-align: center;
    color: var(--text-secondary);
    padding: 5px;
    position: relative;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    transition: color 0.5s ease;
    box-sizing: border-box;
    overflow: hidden;
}

/* Guide Icons now in modal */
#guide-selection-modal-content #guide-icons-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 columns for modal */
    gap: 15px;
    width: 100%;
    max-width: 240px;
    margin: 15px auto;
}

#guide-selection-modal-content .guide-icon {
    font-size: 42px; /* Larger in modal */
    cursor: pointer;
    padding: 10px;
    border-radius: var(--border-radius-small);
    transition: transform 0.2s ease, color 0.2s ease;
    color: var(--text-primary);
    text-align: center;
}
#guide-selection-modal-content .guide-icon:hover {
    transform: scale(1.15);
    color: var(--accent-pink);
}


/* Shop content now in modal */
#shop-modal-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 12px;
    padding: 15px 5px;
    align-items: stretch;
    overflow-y: auto;
}

/* Pet Module Refinements for shorter window */
.side-window-content#pet-content {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    padding: 5px;
    height: 100%;
    box-sizing: border-box;
}
.pet-info-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 3px;
    width: 100%;
    flex-grow: 1;
    padding: 2px 0;
}
.pet-main-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
    width: 100%;
}
.pet-display {
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 58px;
}
.pet-status-emoji {
    font-size: 54px; /* Reduced */
}
.pet-description {
    font-size: 12px; /* Reduced */
    color: var(--text-primary);
    min-height: 18px;
    font-weight: 500;
    text-align: center;
    line-height: 1.2;
    width: 90%;
    margin-top: 3px;
}

.pet-bottom-area {
    width: 100%;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    padding-bottom: 2px;
    margin-top: 3px;
}
#pet-toy-display {
    font-size: 24px; /* Reduced */
    line-height: 1;
    min-height: 26px;
}
.alien-visitor-text { /* General alien text styling */
    font-size: 14px; /* Reduced */
    font-weight: bold;
    color: var(--accent-green); /* Alien green */
    text-shadow: 0 0 5px var(--accent-green);
    line-height: 1.3;
    text-align: center;
    width: 100%;
    padding: 5px 0;
}
.alien-emoji-large {
    font-size: 54px; /* Reduced */
    line-height: 1;
    display: inline-block;
    margin-bottom: 5px;
}
.pet-food-consumption {
    font-size: 11px;
    color: var(--text-secondary);
    width: 100%;
    text-align: center;
    line-height: 1;
}


/* Phone Module & UI Refinements */
.side-window-content#phone-container {
    justify-content: space-between;
    padding: 0; /* REMOVED padding to allow UI to fill space */
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    position: relative; /* ADDED for absolute positioning of children */
}
#phone-content {
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    flex-direction: column;
    overflow: hidden;
    padding: 10px; /* Padding now on content itself */
    box-sizing: border-box;
}
.phone-controls-bar {
    display: flex;
    justify-content: space-around;
    align-items: center;
    gap: 15px;
    padding: 10px;
    width: 100%;
    border-top: 1px solid var(--bg-panel-accent);
    flex-shrink: 0;
    box-sizing: border-box;
    z-index: 5; /* Ensure controls are above background content */
    background: var(--bg-panel); /* Add background to controls */
    border-radius: 0 0 var(--border-radius-main) var(--border-radius-main);
}

.feature-control-item { position: relative; display: flex; align-items: center; flex-direction: column; }
.investments-area { font-size: 42px; opacity: 0.7; cursor: pointer; line-height: 1; transition: opacity 0.3s ease, transform 0.2s ease; }
.investments-area:hover:not(.disabled) { opacity: 1; transform: scale(1.1); color: var(--accent-pink); }
.investments-area.disabled { opacity: 0.4; cursor: not-allowed; }
.feature-countdown { font-size: 14px; font-weight: bold; color: var(--accent-yellow); line-height: 1; /*animation: yellowGlow 1.5s infinite;*/ margin-top: 3px;} /* Removed default glow, theme specific */

.text-message { font-size: 16px; font-weight: 500; animation: popIn 0.5s ease-out forwards; padding: 8px; border-radius: var(--border-radius-small); background: var(--bg-panel-accent); box-shadow: var(--shadow-subtle); line-height: 1.3;}
.text-message.friendly { color: var(--accent-green); }
.text-message.loss { color: var(--accent-red); }

.investment-ui, .takeout-ui {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 10px; /* Increased gap for better spacing */
    background: var(--bg-panel); /* Match panel background */
    box-sizing: border-box;
    /* NEW styles for full-window takeover */
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
    justify-content: center;
    padding: 20px;
    border-radius: var(--border-radius-main); /* Match parent rounding */
}
.investment-ui span:first-child,
.takeout-ui span:first-child {
    font-size: 14px; /* Larger text */
    line-height: 1.3;
    color: var(--text-secondary);
    margin-bottom: 4px;
    text-align: center;
    word-wrap: break-word;
}
.investment-ui #invest-amount-display,
.takeout-ui #takeout-amount-display {
    font-size: 18px; /* Larger text */
    font-weight: bold;
    color: var(--text-primary);
    text-align: center;
    margin: 4px 0;
}
.investment-ui input[type="range"],
.takeout-ui input[type="range"] {
    width: 100%;
    cursor: pointer;
    accent-color: var(--accent-pink); /* Will be overridden by theme if needed */
    margin: 8px 0; /* More margin */
}
.investment-ui button,
.takeout-ui button {
    margin-top: 8px; /* More margin */
    padding: 10px 15px; /* Larger button */
    font-size: 16px;
}

.investment-result { font-size: 20px; animation: investmentResult 0.8s ease-out forwards; font-weight: 600; text-align: center; padding: 5px;}
.investment-result.profit { color: var(--accent-green); }
.investment-result.loss { color: var(--accent-red); }
.investment-result.takeout-confirm { color: var(--accent-blue); }


/* Bird Module */
#bird-animation-area { position: absolute; top: 0; left: 0; right: 0; bottom: 105px; pointer-events: none; overflow: hidden; z-index: 15; } /* Adjusted for shorter window */
.bird-display { position: absolute; opacity: 0; z-index: 10; transform: translate(-50%, -50%); transition: opacity 0.3s ease-in-out, transform 0.5s ease; }
.bird-display.parrot { font-size: 36px; left: 50%; top: 20%; } /* Reduced size */
.bird-display.owl { font-size: 32px; left: 50%; top: 40%; } /* Reduced size */
.bird-display.dove { font-size: 32px; left: 50%; top: 60%; } /* Reduced size */
.bird-display.phoenix { font-size: 36px; left: 50%; top: 80%; animation: pinkGlow 2s infinite; } /* Reduced size */
.window-item-container { display: flex; flex-direction: column; align-items: center; text-align: center; min-width: 65px; min-height: 48px; } /* Reduced min-height */
.window-item-container span:first-child { font-size: 28px !important; } /* Reduced size */
#nest-display { font-size: 34px !important; } /* Reduced size */
.window-item-description { font-size: 10px; color: var(--text-secondary); margin-top: 2px; opacity: 0.9; min-height: 11px; line-height: 1.1; word-break: break-word; } /* Reduced size */
#window-bottom-bar { position: absolute; bottom: 5px; left: 5px; right: 5px; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: auto auto; gap: 5px; z-index: 5; padding: 0 5px; height: 100px; justify-items: center; align-items: start; } /* Adjusted for shorter window */


/* Left Utility Panel */
.left-utility-panel { display: flex; flex-direction: column; gap: 15px; align-items: center; width: 100px; }
.power-meter-container { display: flex; flex-direction: column; align-items: center; gap: 10px; width: 100%; padding: 15px; height: auto; flex-grow: 1; justify-content: flex-start;}
#power-meter-indicator-icon { font-size: 30px; color: var(--accent-blue); display: flex; justify-content: center; align-items: center; gap: 2px; min-height: 32px; /*animation: accentGlow 2s infinite;*/ } /* Base glow removed for theme specific */
.power-penalty-indicator { font-size: 18px; } /* Slightly smaller penalty icons */
.quantum-indicator { color: var(--accent-lime); } /* Quantum penalty color */
.cosmic-indicator { color: var(--accent-pink); } /* Cosmic penalty color */
.power-meter-bar { width: 30px; height: 180px; background-color: var(--bg-panel-accent); border: 1px solid var(--accent-blue); border-radius: var(--border-radius-small); position: relative; overflow: hidden; box-shadow: inset 0 0 5px rgba(0,0,0,0.5); }
.power-meter-fill { width: 100%; background: linear-gradient(to bottom, var(--accent-yellow), var(--accent-orange)); position: absolute; bottom: 0; left: 0; transition: height 0.4s ease-in-out, background 0.5s ease; border-radius: 0 0 5px 5px; }
.next-power-bill-display { font-size: 11px; font-weight: 500; color: var(--text-secondary); text-align: center; margin-top: 8px; line-height: 1.3; width: 100%; }

.status-effects-window { padding: 10px 8px; width: 100%; min-height: 125px; display: flex; flex-direction: column; justify-content: flex-start; gap: 8px; font-size: 12px; color: var(--text-primary); text-align: center; flex-shrink: 0; }
.status-effect-item { min-height: 22px; line-height: 1; display: flex; justify-content: center; align-items: center; gap: 8px; }
.buff-emoji { font-size: 20px; }
.buff-countdown { font-size: 16px; font-weight: bold; color: var(--accent-yellow); /*animation: yellowGlow 1.5s infinite; */ margin-top: 1px; } /* Removed default glow */

/* New trigger buttons on the left panel */
.utility-trigger {
    padding: 10px;
    width: 100%;
    flex-shrink: 0; /* Prevent shrinking */
}
.utility-btn {
    font-size: 40px;
    width: 60px;
    height: 60px;
    margin: auto;
    border-radius: var(--border-radius-main);
    background-color: var(--bg-panel-accent);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
}
.utility-btn:hover {
    background-color: var(--bg-panel);
    color: var(--accent-pink);
    transform: scale(1.05);
}


/* Shop Item Button Refinements (Using Teal as an example, themes can override) */
.shop-item-btn {
    padding: 8px 10px;
    font-size: 14px;
    border: 1px solid var(--accent-teal); /* Default shop item color */
    border-radius: var(--border-radius-small);
    cursor: pointer;
    transition: background-color 0.3s ease, filter 0.3s ease, opacity 0.2s ease, transform 0.2s ease;
    font-weight: 500;
    text-align: center;
    background-color: var(--accent-teal);
    color: var(--bg-main);
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    width: 100%;
    opacity: 1;
}

.shop-item-cost {
    font-weight: bold;
}

.shop-item-btn:not(:disabled) {
    filter: brightness(1.05);
}

.shop-item-btn:hover:not(:disabled) {
    filter: brightness(1.15);
    transform: translateY(-1px);
}

.shop-item-btn:disabled {
    background-color: var(--accent-teal); /* Keep base color but dim */
    color: var(--bg-main);
    border-color: var(--accent-teal);
    cursor: not-allowed;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    opacity: 0.6;
    transform: none;
    filter: brightness(0.85);
}


/* --- Game Area --- */
.game {
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    width: 520px;
}
.game.food-warning {
    background: var(--accent-red) !important;
    border-color: var(--accent-orange) !important;
    box-shadow: 0 0 20px var(--accent-red), 0 0 10px var(--accent-red) inset !important;
}
.game.food-warning .food-meter-icon, .game.food-warning .food-meter-value { color: var(--bg-main); }

.food-meter-container { width: 100%; display: flex; align-items: center; gap: 8px; margin-bottom: 15px; font-size: 20px; font-weight: bold; color: var(--text-primary); }
.food-icon-area { display: flex; flex-direction: column; align-items: center; text-align: center; width: 45px; }
.food-meter-icon { font-size: 32px; line-height: 1; color: var(--accent-green); }
.food-meter-value { font-size: 13px; font-weight: 500; color: var(--text-secondary); margin-top: 2px; line-height: 1; }
.food-meter { flex-grow: 1; background-color: var(--bg-panel-accent); border: 1px solid var(--accent-green); border-radius: var(--border-radius-small); height: 28px; overflow: hidden; box-shadow: inset 0 1px 4px rgba(0,0,0,0.4); }
.food-meter-fill { height: 100%; background: linear-gradient(to left, var(--accent-green), #00b377); width: 100%; transition: width 0.4s ease-in-out, background 0.5s ease; border-radius: 5px 0 0 5px; }

.symbol-inventory { margin: 10px 0 15px; font-size: 22px; text-align: center; color: var(--text-secondary); min-height: 35px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;}
.symbol-inventory span { margin: 0 5px; display: inline-block; transition: transform 0.2s ease; padding: 3px 5px; background: rgba(0,0,0,0.1); border-radius: 4px;}
.symbol-inventory span:hover { transform: scale(1.15); color: var(--accent-pink); }

/* Pre-Slot Controls (Lucky Lines & Lock Button) Styling */
.pre-slot-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    max-width: 460px;
    margin: 0 auto 10px auto;
    height: 40px;
    padding: 0 10px;
    box-sizing: border-box;
}

#lucky-btn {
    padding: 8px 12px;
    font-size: 13px;
    line-height: 1.2;
    flex-shrink: 0;
    /* Default styling inherited from .btn will apply */
}

/* #lucky-btn.active is handled by the combined selector .btn-spin-lucky, #lucky-btn.active */

#lock-btn-el {
    font-size: 28px;
    color: var(--accent-blue);
    cursor: pointer;
    padding: 5px;
    border-radius: var(--border-radius-small);
    transition: color 0.2s ease, transform 0.2s ease;
}
#lock-btn-el:hover:not([disabled]) {
    color: var(--accent-pink);
    transform: scale(1.1);
}
#lock-btn-el[disabled] {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

.slot-grid { display: grid; grid-template-columns: repeat(4, 85px); grid-template-rows: repeat(2, 85px); gap: 12px; margin: 0 auto 10px auto; position: relative; }

/* Win Display Refinement */
.win-display {
    font-size: 18px;
    font-weight: bold;
    color: var(--accent-yellow);
    margin-top: 0px;
    margin-bottom: 10px;
    min-height: 24px;
    text-align: center;
    text-shadow: 0 0 5px rgba(248, 216, 0, 0.6);
}
.win-display.game-over {
    color: var(--accent-red);
    text-shadow: none;
    font-size: 20px;
}


.slot-cell {
    width: 85px; height: 85px; display: flex; justify-content: center; align-items: center; font-size: 42px;
    background: var(--bg-panel-accent);
    border: 2px solid var(--accent-blue);
    border-radius: var(--border-radius-small);
    position: relative; cursor: default;
    transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background 0.3s ease;
    box-shadow: 0 3px 6px rgba(0,0,0,0.2), inset 0 0 5px rgba(0,0,0,0.3);
    animation: popIn 0.4s ease-out forwards;
    opacity: 0;
}
.slot-cell:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 6px 12px rgba(0,0,0,0.3), inset 0 0 8px rgba(0,0,0,0.4), 0 0 10px var(--accent-pink);
    border-color: var(--accent-pink);
}
.slot-cell.clickable-food { cursor: pointer; border-color: var(--accent-green); box-shadow: 0 0 10px var(--accent-green), inset 0 0 5px var(--accent-green); }
.slot-cell.clickable-food:hover { border-color: var(--accent-green); box-shadow: 0 0 15px var(--accent-green), inset 0 0 8px var(--accent-green); transform: scale(1.08); }
.slot-cell.clickable-cat { cursor: pointer; border-color: var(--accent-pink); box-shadow: 0 0 10px var(--accent-pink), inset 0 0 5px var(--accent-pink); }
.slot-cell.clickable-cat:hover { border-color: var(--accent-pink); box-shadow: 0 0 15px var(--accent-pink), inset 0 0 8px var(--accent-pink); transform: scale(1.08); }

.slot-cell .payout-text { position: absolute; bottom: -5px; right: -5px; font-size: 26px; color: var(--accent-yellow); font-weight: bold; opacity: 0; text-shadow: 1px 1px 3px rgba(0,0,0,0.8); pointer-events: none; background: rgba(10,15,30,0.7); padding: 2px 6px; border-radius: 5px 0 5px 0; z-index: 10;} /* Ensure payout text is above cat emoji */
.slot-cell .base-value-text { position: absolute; top: 2px; left: 4px; font-size: 15px; font-weight: 600; text-shadow: 1px 1px 2px rgba(0,0,0,0.7); pointer-events: none; opacity: 0.9; z-index: 1; background: rgba(10,15,30,0.5); padding: 1px 4px; border-radius: 3px;}
.multiplier-value-text { position: absolute; top: 2px; right: 4px; font-size: 18px; font-weight: bold; text-shadow: 0 0 5px var(--accent-pink); pointer-events: none; z-index: 2; background: rgba(10,15,30,0.5); padding: 1px 4px; border-radius: 3px;}
.slot-cell.top-right-locked { background-color: var(--accent-orange); border-color: var(--accent-yellow); box-shadow: 0 0 10px var(--accent-orange), inset 0 0 5px var(--accent-yellow); }


/* --- New Payout Number Styling --- */
.base-value-text.base-value-base {
    color: var(--text-secondary); /* Light Gray */
}
.base-value-text.base-value-buffed {
    color: var(--accent-yellow); /* Gold */
    text-shadow: 0 0 5px var(--accent-yellow);
}
.base-value-text.base-value-in-multi-2x {
    color: var(--multiplier-2x-color);
    text-shadow: 0 0 4px #fff, 0 0 2px #fff;
}
.base-value-text.base-value-in-multi-3x {
    color: var(--multiplier-3x-color);
    text-shadow: 0 0 4px #fff, 0 0 2px #fff;
}
.base-value-text.base-value-in-multi-5x {
    color: var(--multiplier-5x-color);
    text-shadow: 0 0 4px #fff, 0 0 2px #fff;
}


/* --- Controls & Buttons --- */
.controls {
    display: flex;
    gap: 15px;
    align-items: center;
    flex-direction: column;
    margin-top: 10px; /* Pushes spin button down slightly */
    margin-bottom: 10px; /* Adjusted bottom margin */
}
.btn {
    padding: 12px 28px; font-size: 18px; border: none; border-radius: var(--border-radius-small); cursor: pointer;
    transition: all 0.25s ease;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 -2px 3px rgba(0,0,0,0.2);
    font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;
    background: linear-gradient(145deg, var(--accent-blue), #00a8c8);
    color: var(--bg-main);
}
.btn:hover:not(:disabled) {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 6px 12px rgba(0,0,0,0.4), inset 0 -1px 2px rgba(0,0,0,0.1), 0 0 10px var(--accent-blue);
    filter: brightness(1.1);
}
.btn:active:not(:disabled) {
    transform: translateY(0px) scale(0.98);
}

/* Upgrade Buttons (.btn-upgrade) Refinements */
.upgrades-container {
    display: flex;
    gap: 15px;
    margin-top: 15px;
    justify-content: center;
    width: 100%;
}

.btn-upgrade { /* Default upgrade button style (Cosmic will use Magenta) */
    background: var(--accent-magenta);
    color: var(--text-primary);
    padding: 10px 20px;
    font-size: 15px;
    border: 1px solid var(--accent-magenta);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2), 0 0 8px var(--accent-magenta);
    line-height: 1.3; /* For two lines of text */
    text-align: center;
}
.btn-upgrade:hover:not(:disabled) {
    background: var(--accent-pink); /* Default hover, can be themed */
    box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 0 12px var(--accent-pink);
    filter: brightness(1.15);
}
.btn-upgrade:disabled {
    background: #4a234a; /* Default disabled, can be themed */
    color: #947994;
    border-color: #4a234a;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
    cursor: not-allowed;
    filter: none;
    transform: none;
    opacity: 0.7;
}
.btn-upgrade.active-glow:not(:disabled) {
    /* Default glow is pink, themes will override */
    animation: pinkGlow 1.5s infinite;
    box-shadow: 0 0 10px var(--accent-magenta), 0 0 20px var(--accent-magenta), 0 2px 5px rgba(0,0,0,0.2);
}
.upgrade-cost-text {
    font-size: 0.85em;
    font-weight: normal;
    opacity: 0.9;
    display: block;
    margin-top: 2px;
    color: inherit;
}


.coin-display {
    font-size: 20px;
    font-weight: bold;
    color: var(--text-primary);
    margin-top: 15px; /* Adjusted slightly if controls moved */
    text-align: center;
}

.inventory-window {
    width: 100%;
    margin-top: 20px;
    padding: 15px;
    background: var(--bg-panel-accent);
}
.inventory-content {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
    font-size: 18px;
}
.inventory-item {
    padding: 5px 8px;
    background: var(--bg-panel);
    border-radius: var(--border-radius-small);
    box-shadow: var(--shadow-subtle);
    color: var(--text-secondary);
}
.inventory-item.clickable {
    cursor: pointer;
    color: var(--accent-blue);
    transition: color 0.2s, transform 0.2s;
}
.inventory-item.clickable:hover {
    color: var(--accent-pink);
    transform: scale(1.05);
}
.inventory-item.clickable.inventory-item-gift {
    color: var(--accent-yellow);
    animation: yellowGlow 1.5s infinite;
}
.inventory-item.clickable[style*="opacity: 0.7"] {
    cursor: not-allowed;
    color: var(--text-secondary);
    transform: none; /* Prevent hover scale on disabled-like items */
}


#reset-game-btn-container {
    margin-top: 25px;
    width: 100%;
    display: flex;
    justify-content: center;
}
#reset-game-btn {
    background: var(--accent-red);
    color: var(--text-primary);
    padding: 8px 15px;
    font-size: 14px;
}
#reset-game-btn:hover:not(:disabled) {
    background: #ff6030;
    box-shadow: 0 0 8px var(--accent-red);
}

/* Guide Popup & Modals */
#guide-popup-overlay, .modal-overlay { /* Combined for similar overlay behavior */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.85); /* Slightly darker */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    transition: opacity 0.3s ease;
    padding: 20px;
    box-sizing: border-box;
}
#guide-popup-overlay.hidden, .modal-overlay.hidden {
    opacity: 0;
    pointer-events: none;
}

#guide-popup-window { /* Specifics for guide if needed */
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    /* background, padding, border-radius, box-shadow inherited from .modal-window */
    position: relative;
    display: flex;
    flex-direction: column;
}

.modal-window {
    width: 90%;
    max-width: 500px;
    max-height: 90vh;
    position: relative;
    display: flex;
    flex-direction: column;
}
.modal-title {
    font-size: 22px;
    color: var(--accent-blue);
    text-align: center;
    margin: -10px 0 15px 0;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--accent-blue);
}


#guide-popup-close-btn, .modal-close-btn { /* Combined close button styles */
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 30px;
    color: var(--text-secondary);
    background: none;
    border: none;
    cursor: pointer;
    transition: color 0.2s ease;
    line-height: 1;
    z-index: 1001;
}
#guide-popup-close-btn:hover, .modal-close-btn:hover {
    color: var(--accent-pink);
}
#guide-popup-content, .modal-content { /* Combined content styles */
    overflow-y: auto;
    font-size: 15px;
    line-height: 1.6;
    color: var(--text-primary);
    text-align: left; /* Default for modals, guide can override if needed */
}
.modal-content {
    text-align: center; /* Center text for simple modals like payout */
    padding: 10px;
}
.modal-content strong { /* Ensure strong tag is colored in modal */
    color: var(--accent-yellow);
}
.payout-option {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    background-color: var(--bg-panel-accent);
    transition: all 0.3s ease;
    margin: 0 5px;
}
.payout-option.highlight {
    color: var(--accent-yellow);
    text-shadow: 0 0 8px var(--accent-yellow);
    transform: scale(1.1);
    background-color: transparent;
    font-weight: bold;
}

#guide-popup-content h4 {
    font-size: 20px;
    color: var(--accent-blue);
    margin-top: 15px;
    margin-bottom: 10px;
    border-bottom: 1px solid var(--accent-blue);
    padding-bottom: 5px;
}
#guide-popup-content h4:first-child {
    margin-top: 0;
}
#guide-popup-content p {
    margin-bottom: 10px;
}
#guide-popup-content ul {
    list-style-type: disc;
    margin-left: 20px;
    margin-bottom: 10px;
}
#guide-popup-content li {
    margin-bottom: 5px;
}
#guide-popup-content strong {
    color: var(--accent-yellow);
    font-weight: 600;
}

/* Gift Choice Modal */
#gift-choice-content h4 {
    font-size: 22px;
    color: var(--accent-yellow);
    text-align: center;
    border: none;
    margin-bottom: 10px;
}
#gift-choice-content p {
    text-align: center;
    color: var(--text-secondary);
    margin-bottom: 20px;
}
.gift-choices-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    align-items: center;
}
.gift-choices-container .btn {
    width: 80%;
    font-size: 16px;
    padding: 12px 20px;
    text-transform: none;
}


/* Cosmic Theme Specifics */
body.cosmic-theme {
    --bg-main: #1D0C2C;
    --bg-panel: #2D1A4C;
    --bg-panel-accent: #3D2A6C;
    --text-primary: #E8E0F8;
    --text-secondary: #C0B0E0;
    --accent-blue: #A080FF; /* Cosmic Blue/Purple */
    --accent-pink: #FF80F0; /* Cosmic Pink */
    --accent-yellow: #F8F0A0; /* Cosmic Yellow */
    --accent-green: #80F8C0; /* Cosmic Green */
    --accent-orange: #FFB070; /* Cosmic Orange */
    --accent-red: #FF70A0; /* Cosmic Red */
    --shadow-color: rgba(160, 128, 255, 0.15);
    --shadow-color-pink: rgba(255, 128, 240, 0.15);
}
body.cosmic-theme #game-main-title.upgrade-mode-active {
    color: var(--accent-pink); /* Cosmic Pink title */
    text-shadow: 0 0 8px var(--accent-pink), 0 0 15px var(--accent-pink), 0 0 25px var(--accent-pink);
}
body.cosmic-theme .slot-cell { border-color: var(--accent-blue); } /* Cosmic themed border */

body.cosmic-theme .power-meter-fill { background: linear-gradient(to bottom, var(--accent-pink), var(--accent-blue)); }
body.cosmic-theme #power-meter-indicator-icon { color: var(--accent-blue); animation: accentGlow 2s infinite; } /* Glow for cosmic power */
body.cosmic-theme .buff-countdown { color: var(--accent-yellow); animation: limeGlow 1.5s infinite alternate; } /* Use lime for countdowns in cosmic for contrast */
body.cosmic-theme #quantum-upgrade-btn { /* Style for the other upgrade button when this theme is active */
    background: #553c73; color: #a98dc2; border-color: #553c73;
}
body.cosmic-theme #quantum-upgrade-btn.active-glow:not(:disabled) {
     animation: none; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}


/* Quantum Theme Specifics */
body.quantum-theme {
    --bg-main: #282c34; /* Dark Gray */
    --bg-panel: #3a3f4b; /* Mid Gray */
    --bg-panel-accent: #4a4f5b; /* Lighter Gray */
    --text-primary: #E0E8F0; /* Light Bluish Gray Text */
    --text-secondary: #A8B0C0; /* Mid Bluish Gray Text */
    --accent-blue: var(--accent-lime); /* Lime for primary accent in quantum */
    --accent-pink: #80F8A8; /* Using a slightly different green for pink's role if needed */
    --accent-yellow: #D0F8A0; /* Lighter lime/yellow */
    --accent-green: var(--accent-lime); /* Main Green is Lime */
    --accent-orange: #B0F888;
    --accent-red: #F88888;
    --accent-lime: #A0F800; /* Explicitly defined Lime */

    --shadow-color: rgba(160, 248, 0, 0.2); /* Lime glow */
    --shadow-color-pink: rgba(128, 248, 168, 0.2); /* Lighter green for secondary glow if needed */
}

body.quantum-theme #game-main-title.upgrade-mode-active {
    color: var(--accent-lime);
    text-shadow: 0 0 8px var(--accent-lime), 0 0 15px var(--accent-lime), 0 0 25px var(--accent-lime);
}
body.quantum-theme .slot-cell { border-color: var(--accent-lime); }

body.quantum-theme .power-meter-fill { background: linear-gradient(to bottom, var(--accent-lime), #6AAE28); }
body.quantum-theme #power-meter-indicator-icon { color: var(--accent-lime); animation: limeGlow 2s infinite; }
body.quantum-theme .buff-countdown { color: var(--accent-lime); animation: limeGlow 1.5s infinite alternate; }
body.quantum-theme .btn-upgrade { /* Quantum upgrade button in its own theme */
    background: var(--accent-lime); color: var(--bg-main); border-color: var(--accent-lime);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2), 0 0 8px var(--accent-lime);
}
body.quantum-theme .btn-upgrade:hover:not(:disabled) {
    background: #BFFF00; box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 0 12px #BFFF00;
}
body.quantum-theme .btn-upgrade.active-glow:not(:disabled) { animation: limeGlow 1.5s infinite alternate; }
body.quantum-theme #cosmic-upgrade-btn { /* Style for Cosmic button when Quantum theme is active */
    background: #3a2d4a; color: #8f7c9f; border-color: #3a2d4a;
}
body.quantum-theme #cosmic-upgrade-btn.active-glow:not(:disabled) {
     animation: none; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
body.quantum-theme .shop-item-btn {
    background-color: var(--accent-lime); border-color: var(--accent-lime); color: var(--bg-main);
}
body.quantum-theme .shop-item-btn:disabled {
     background-color: var(--accent-lime); border-color: var(--accent-lime); color: var(--bg-main);
     filter: brightness(0.85); opacity: 0.6;
}
body.quantum-theme .investment-ui input[type="range"],
body.quantum-theme .takeout-ui input[type="range"] {
    accent-color: var(--accent-lime);
}


/* Multiplier Slot Visuals (New Solid Backgrounds) */
.slot-cell.multi-2x {
    background-color: var(--multiplier-2x-color);
    border-color: var(--multiplier-2x-color) !important;
    box-shadow: 0 0 10px var(--multiplier-2x-color), inset 0 0 8px rgba(255,255,255,0.2);
}
.slot-cell.multi-3x {
    background-color: var(--multiplier-3x-color);
    border-color: var(--multiplier-3x-color) !important;
    box-shadow: 0 0 10px var(--multiplier-3x-color), inset 0 0 8px rgba(255,255,255,0.2);
}
.slot-cell.multi-5x {
    background-color: var(--multiplier-5x-color);
    border-color: var(--multiplier-5x-color) !important;
    box-shadow: 0 0 10px var(--multiplier-5x-color), inset 0 0 8px rgba(255,255,255,0.2);
}
/* Multiplier Text Number Styling */
.slot-cell.multi-2x .multiplier-value-text,
body.cosmic-theme .slot-cell.multi-2x .multiplier-value-text,
body.quantum-theme .slot-cell.multi-2x .multiplier-value-text {
    color: var(--multiplier-2x-color);
    text-shadow: 0 0 3px #fff, 0 0 6px #fff;
    background: rgba(255,255,255,0.15);
}
.slot-cell.multi-3x .multiplier-value-text,
body.cosmic-theme .slot-cell.multi-3x .multiplier-value-text,
body.quantum-theme .slot-cell.multi-3x .multiplier-value-text {
    color: var(--multiplier-3x-color);
    text-shadow: 0 0 3px #fff, 0 0 6px #fff;
    background: rgba(255,255,255,0.15);
}
.slot-cell.multi-5x .multiplier-value-text,
body.cosmic-theme .slot-cell.multi-5x .multiplier-value-text,
body.quantum-theme .slot-cell.multi-5x .multiplier-value-text {
    color: var(--multiplier-5x-color);
    text-shadow: 0 0 3px #fff, 0 0 6px #fff;
    background: rgba(255,255,255,0.15);
}


.max-feathers {
    color: var(--accent-yellow);
    text-shadow: 0 0 5px var(--accent-yellow);
}

/* Schrodinger Cat Effect for Quantum Mode */
.schrodinger-cat-effect {
    position: relative; /* Needed for pseudo-element positioning */
    /* Distinct visual cue for the 10x cell */
    box-shadow: 0 0 12px var(--accent-lime), 0 0 20px var(--accent-lime), inset 0 0 8px var(--accent-lime) !important;
    border: 3px dashed var(--accent-lime) !important; /* Dashed lime border */
    background-color: rgba(160, 248, 0, 0.1) !important; /* Slight lime tint */
}

.schrodinger-cat-effect::after {
    content: "üêà"; /* Schrodinger's Cat Emoji */
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 60px; /* Larger size */
    z-index: 5; 
    pointer-events: none;

    /* New gradient overlay effect */
    background: linear-gradient(45deg, var(--accent-lime), var(--accent-green));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    opacity: 0.8; /* Less transparent */
    text-shadow: none; /* Remove previous shadow */
}