<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Emoji Rogue Slots</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
    <style>
        /* Disables pull-to-refresh and other disruptive browser gestures on mobile */
        body {
            overscroll-behavior-y: contain;
            font-family: 'Anton', sans-serif;
            -webkit-tap-highlight-color: transparent; /* Disable tap highlight on mobile */
            background-color: #111111;
        }

        /* Original "jitter" slot machine reel animation */
        .reel.spinning {
            animation: spinReel 0.1s linear infinite;
        }
        
        @keyframes spinReel {
            0% { transform: translateY(-20%); }
            100% { transform: translateY(20%); }
        }

        /* General UI styling for a sharper, gothic look */
        .ui-panel {
            background-color: #1f2937; /* A very dark, muted blue-gray */
            border: 1px solid #4b5563;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }

        .action-button {
            transition: transform 0.1s ease, background-color 0.1s ease;
            border: 1px solid #4b5563;
        }

        .action-button:active {
            transform: scale(0.95);
        }

        .text-glow {
            text-shadow: 0 0 5px rgba(209, 196, 233, 0.4), 0 0 8px rgba(167, 139, 250, 0.3);
        }
        
        .text-glow-red {
             text-shadow: 0 0 4px rgba(239, 68, 68, 0.6), 0 0 8px rgba(220, 38, 38, 0.4);
        }

        /* Custom scrollbar for a more integrated look */
        #enemy-info::-webkit-scrollbar {
            width: 4px;
        }

        #enemy-info::-webkit-scrollbar-thumb {
            background-color: #991b1b; /* red-800 */
            border-radius: 2px;
        }
        
        #enemy-info::-webkit-scrollbar-track {
            background-color: #1f2937;
        }
    </style>
</head>
<body class="text-gray-300 flex flex-col h-screen select-none antialiased">

    <!-- Top Section: Player Stats & Resources -->
    <header class="p-3 ui-panel border-b-2 border-red-800 space-y-2">
        <!-- Top Row: Level and Resources -->
        <div class="flex justify-between items-center text-lg">
            <span id="player-level" class="font-bold text-glow">LVL: 1</span>
            <div class="flex items-center space-x-4">
                <span id="player-armor" class="font-semibold text-glow">🛡️ 5</span>
                <span id="player-gold" class="font-semibold text-glow">💰 125</span>
                <span id="player-gems" class="font-semibold text-glow">💎 10</span>
            </div>
        </div>

        <!-- Health Bar -->
        <div class="w-full bg-gray-900 h-5 border border-gray-700">
            <div id="health-bar" class="bg-gradient-to-r from-red-800 to-red-900 h-full text-center text-xs font-bold leading-5 transition-all duration-300" style="width: 85%;">HP: 85/100</div>
        </div>

        <!-- MP Bar -->
        <div class="w-full bg-gray-900 h-5 border border-gray-700">
            <div id="mp-bar" class="bg-gradient-to-r from-purple-800 to-indigo-900 h-full text-center text-xs font-bold leading-5 transition-all duration-300" style="width: 70%;">MP: 70/100</div>
        </div>

        <!-- XP Bar -->
        <div class="w-full bg-gray-900 h-4 border border-gray-700">
            <div id="xp-bar" class="bg-gradient-to-r from-amber-700 to-amber-800 h-full text-center text-xs font-bold leading-4 transition-all duration-300" style="width: 40%;">XP: 40/100</div>
        </div>
    </header>

    <!-- Middle Section: Slot Machine and Enemy Info -->
    <main class="flex-grow flex flex-col justify-center items-center p-4 overflow-hidden">
        <!-- Enemy Info Display -->
        <div id="enemy-info" class="w-full max-w-md h-24 ui-panel p-2 mb-4 overflow-y-auto">
             <p id="enemy-info-text" class="text-center text-gray-400">Spin to encounter enemies!</p>
        </div>

        <!-- Slot Machine -->
        <div class="w-full max-w-md ui-panel p-4 border-2 border-red-800">
            <div id="slot-machine" class="flex justify-around items-center h-32 text-6xl">
                <div class="reel w-1/3 text-center bg-black p-2 mx-1 border border-gray-700 flex justify-center items-center">💀</div>
                <div class="reel w-1/3 text-center bg-black p-2 mx-1 border border-gray-700 flex justify-center items-center">🐺</div>
                <div class="reel w-1/3 text-center bg-black p-2 mx-1 border border-gray-700 flex justify-center items-center">🐸</div>
            </div>
        </div>
    </main>

    <!-- Bottom Section: Actions -->
    <footer class="p-3 ui-panel border-t-2 border-red-800 flex flex-col gap-3">
        <!-- Primary Actions -->
        <div class="grid grid-cols-3 gap-3">
            <button data-name="Attack" class="action-button bg-gray-700 hover:bg-gray-600 p-3 text-lg font-bold flex flex-col items-center justify-center h-20"><span>⚔️</span><span class="text-sm">Attack</span></button>
            <button class="action-button text-2xl font-bold bg-gradient-to-r from-red-800 to-red-900 hover:from-red-700 hover:to-red-800 p-4 h-20" id="spin-button">
                SPIN
            </button>
            <button data-name="Spells" class="action-button bg-gray-700 hover:bg-gray-600 p-3 text-lg font-bold flex flex-col items-center justify-center h-20"><span>✨</span><span class="text-sm">Spells</span></button>
        </div>
        <!-- Secondary Actions -->
        <div class="grid grid-cols-4 gap-2">
            <button data-name="Equip Slots" class="action-button bg-gray-900 hover:bg-gray-800 p-2 text-base flex flex-col items-center justify-center"><span>🛡️</span><span class="text-xs">Equip</span></button>
            <button data-name="Shop" class="action-button bg-gray-900 hover:bg-gray-800 p-2 text-base flex flex-col items-center justify-center"><span>🛍️</span><span class="text-xs">Shop</span></button>
            <button data-name="Fortunes" class="action-button bg-gray-900 hover:bg-gray-800 p-2 text-base flex flex-col items-center justify-center"><span>🔮</span><span class="text-xs">Fortunes</span></button>
            <button data-name="Luck" class="action-button bg-gray-900 hover:bg-gray-800 p-2 text-base flex flex-col items-center justify-center"><span>🍀</span><span class="text-xs">Luck</span></button>
        </div>
    </footer>

    <!-- Message Display -->
    <div id="message-box" class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 ui-panel border-2 border-red-700 p-6 text-center z-50">
        <p id="message-text" class="text-lg text-glow-red"></p>
    </div>

    <script>
        const spinButton = document.getElementById('spin-button');
        const reels = document.querySelectorAll('.reel');
        const enemyInfoText = document.getElementById('enemy-info-text');
        const messageBox = document.getElementById('message-box');
        const messageText = document.getElementById('message-text');

        // Game State
        let playerState = {
            level: 1,
            hp: 85,
            maxHp: 100,
            armor: 5,
            mp: 70,
            maxMp: 100,
            gold: 125,
            gems: 10,
            xp: 40,
            xpToNextLevel: 100,
        };

        const outcomes = {
            'gift': { emoji: '🎁', name: 'Gift', description: 'A surprise reward!', type: 'reward', value: 25 },
            'skeleton': { emoji: '💀', name: 'Skeleton', hp: 20, damage: 8 },
            'wolf': { emoji: '🐺', name: 'Wolf', hp: 25, damage: 10 },
            'frog': { emoji: '🐸', name: 'Frog', hp: 15, damage: 5, special: '☠️ Poison' },
            'unicorn': { emoji: '🦄', name: 'Unicorn', hp: 30, damage: 0, special: '❇️ Regen', description: 'A Unicorn blesses you!' },
            'dragon': { emoji: '🐲', name: 'Dragon', hp: 120, damage: 30 },
            'serpent': { emoji: '🐍', name: 'Serpent', hp: 22, damage: 12, special: '☠️ Poison' },
            'rat': { emoji: '🐀', name: 'Rat', hp: 10, damage: 4 },
            'crow': { emoji: '🐦‍⬛', name: 'Crow', hp: 18, damage: 6, special: '🕯️ Curse' },
            'spider': { emoji: '🕷️', name: 'Spider', hp: 16, damage: 7, special: '☠️ Poison' },
            'scorpion': { emoji: '🦂', name: 'Scorpion', hp: 28, damage: 15 },
            'mosquito': { emoji: '🦟', name: 'Mosquito', hp: 12, damage: 5, special: '🐌 Sluggish' },
            'zombie': { emoji: '🧟', name: 'Zombie', hp: 35, damage: 10, special: '🐌 Sluggish' },
            'genie': { emoji: '🧞', name: 'Genie', hp: 40, damage: 0, special: '❇️ Regen', description: 'The Genie grants you a wish!' },
            'troll': { emoji: '🧌', name: 'Troll', hp: 50, damage: 18 },
            'ninja': { emoji: '🥷', name: 'Ninja', hp: 25, damage: 10, special: '🫳 Steals 5 gold' },
            'vampire': { emoji: '🧛', name: 'Vampire', hp: 45, damage: 15, special: '🕯️ Curse' },
            'supervillain': { emoji: '🦹', name: 'Supervillain', hp: 80, damage: 25 },
        };
        
        const outcomeKeys = Object.keys(outcomes);
        let isSpinning = false;

        function updateUI() {
            document.getElementById('player-level').textContent = `LVL: ${playerState.level}`;
            document.getElementById('player-armor').textContent = `🛡️ ${playerState.armor}`;
            document.getElementById('player-gold').textContent = `💰 ${playerState.gold}`;
            document.getElementById('player-gems').textContent = `💎 ${playerState.gems}`;

            const healthBar = document.getElementById('health-bar');
            healthBar.style.width = `${(playerState.hp / playerState.maxHp) * 100}%`;
            healthBar.textContent = `HP: ${playerState.hp}/${playerState.maxHp}`;

            const mpBar = document.getElementById('mp-bar');
            mpBar.style.width = `${(playerState.mp / playerState.maxMp) * 100}%`;
            mpBar.textContent = `MP: ${playerState.mp}/${playerState.maxMp}`;
            
            const xpBar = document.getElementById('xp-bar');
            xpBar.style.width = `${(playerState.xp / playerState.xpToNextLevel) * 100}%`;
            xpBar.textContent = `XP: ${playerState.xp}/${playerState.xpToNextLevel}`;
        }

        spinButton.addEventListener('click', () => {
            if (isSpinning) {
                return;
            }
            isSpinning = true;
            updateUI();
            
            enemyInfoText.innerHTML = "";
            
            let finalResults = [];
            
            reels.forEach((reel, index) => {
                reel.classList.add('spinning');
                const spinInterval = setInterval(() => {
                    const randomKey = outcomeKeys[Math.floor(Math.random() * outcomeKeys.length)];
                    reel.textContent = outcomes[randomKey].emoji;
                }, 100);

                setTimeout(() => {
                    clearInterval(spinInterval);
                    reel.classList.remove('spinning');
                    
                    const finalKey = outcomeKeys[Math.floor(Math.random() * outcomeKeys.length)];
                    const finalOutcome = outcomes[finalKey];
                    reel.textContent = finalOutcome.emoji;
                    finalResults.push(finalOutcome);
                    
                    if(finalOutcome.hp){
                        const enemyDisplay = document.createElement('div');
                        enemyDisplay.className = "text-center p-1";
                        let specialText = finalOutcome.special ? ` / ${finalOutcome.special}` : '';
                        enemyDisplay.innerHTML = `<span class="font-bold text-glow-red">${finalOutcome.name}</span> - HP: ${finalOutcome.hp} / ATK: ${finalOutcome.damage}${specialText}`;
                        enemyInfoText.appendChild(enemyDisplay);
                    }
                    
                    // When the last reel stops, process results
                    if(index === reels.length - 1) {
                         processSpinResults(finalResults);
                    }

                }, 1000 + index * 300); // Staggered stop
            });
            
            setTimeout(() => {
                isSpinning = false;
            }, 1000 + (reels.length - 1) * 300);
        });

        function processSpinResults(results) {
             let damageToPlayer = 0;
             let goldGained = 0;
             let hpGained = 0;
             let nonEnemyDescriptions = [];

             results.forEach(res => {
                if (res.damage) {
                    damageToPlayer += res.damage;
                }
                if (res.name === 'Gift') {
                    goldGained += res.value;
                }
                if (res.special === '🫳 Steals 5 gold') {
                    playerState.gold = Math.max(0, playerState.gold - 5);
                    showMessage('The Ninja stole 5 gold!', 1500);
                }
                
                // Friendly specials
                if (res.special === '❇️ Regen') {
                     hpGained += 20; // Example regen value
                }

                if(!res.hp || res.damage === 0) { // It's a reward or a non-damaging creature
                    nonEnemyDescriptions.push(res.description);
                }
             });

             if (damageToPlayer > 0) {
                playerState.hp = Math.max(0, playerState.hp - damageToPlayer);
                showMessage(`You took ${damageToPlayer} damage!`, 1500);
             } else if (nonEnemyDescriptions.length > 0) {
                 // Show messages for positive outcomes if no damage was taken
                 showMessage(nonEnemyDescriptions[0], 1500);
             }
             
             if(goldGained > 0) playerState.gold += goldGained;
             if(hpGained > 0) playerState.hp = Math.min(playerState.maxHp, playerState.hp + hpGained);

             updateUI();
        }
        
        function showMessage(msg, duration = 2000) {
            messageText.textContent = msg;
            messageBox.classList.remove('hidden');
            clearTimeout(messageBox.timeoutId);
            messageBox.timeoutId = setTimeout(() => {
                messageBox.classList.add('hidden');
            }, duration);
        }
        
        document.querySelectorAll('.action-button').forEach(button => {
            if (button.id !== 'spin-button') {
                button.addEventListener('click', () => {
                    if(!isSpinning) {
                        const buttonName = button.dataset.name || button.textContent.trim().replace(/[\d⚡()]/g, '');
                        showMessage(`${buttonName} screen is not yet implemented.`, 1500);
                    }
                });
            }
        });

        // Initial UI setup
        updateUI();
    </script>
</body>
</html>


